# Predefined service templates
If you miss a predefined template and you want to create one for the public, please read the following guide. Fork the repository, create the template and open a pr to the `dev` branch. The community is thankful for every predefined template!

## Service template structure
```
<template-name>
├─volumes
│ ├─volume1
│ ├─volume2
│ ├─volume3
│ └─...
├─config.json
├─service.yml
├─environment.env
└─README.md
```

## Configuration file ([example file](frontend/angular/config.json))
A template must contain a file called `config.json`, which holds metadata about the template.<br>
It consists of following parts:

- `label` - Specifies the display name of the template. This name is used in the list for template selection
- `dir` - Name of the directory, the template is located in e.g.: `1_lamp`
- `type` - Type of the service. One of: `proxy`, `tls-helper`, `frontend`, `backend`, `database` or `db-admin-tool`
- `preselected` - Conditional string which defines, whether a service is initially selected in the list or not.
- `exampleAppInitCmd` - String array of Linux commands, which get executed in a [containerized environment](https://github.com/compose-generator/toolbox). This list of commands are meant to be used for generating example projects or similar. Note that the commands are getting executed in an Alpine Linux container, so make sure to only use commands which are compatible with Alpine.
- `files` - List of important files the template comes with. For example the compose file or certain Dockerfiles.
	- `path`: Path to a particular file
	- `type`: Type of the file. Needs to be one of: `service`, `env`, `docs`, `docker`, `config`
- `questions` - Lists of quesions, which the cli will ask the user.
	- `text` - Question itself (keep it as short as possible).
	- `type` - 1 = Yes/No question, 2 = Text question
	- `defaultValue` - Default value of the question (Will be displayed in braces after the question)
	- `validator` - Validate the user input. All validators are listed in the section about [input validators](#input-validators).
	- `var` - Name of the variable, which the answer of the question will be assigned to.
	- `advanced` - false = show question always, true = show question only in advanced mode
	- `withDockerfile` - false = show question always, true = show question only if the flag `--with-dockerfile` is set
- `volumes` - List of volumes which are used in the compose file
	- `text` - Question for customizing the volume
	- `defaultValue` - Default path on the host system. Relative to the generated compose file
	- `var` - Name of the variable, which the answer of the question will be assigned to (Must have the prefix `VOLUME_`).
	- `advanced` - false = show question always, true = show question only in advanced mode
	- `withDockerfile` - false = show question always, true = show question only if the flag `--with-dockerfile` is set
- `secrets` - List of secrets, that will be generated by the cli
	- `name` - Designation of the secret (should be precise and understandable to the user)
	- `var` - Name of the variable, which the generated password will be assigned to (Must start with an underscore).
	- `length` - Length of the secret in characters

## Service file ([example file](frontend/angular/service.yml))
A template also must contain the main service template file `service.yml`, which contains the container configuration for the stack.<br>
Within the configuration, you can make use of the defined variables in the configuration file with doubled curly braces and a leading dollar sign like so: `${{VARIABLE_NAME}}`.<br>
An example:

```
...
ports:
  - ${{HOST_APP_PORT}}:80
...
```

There are two variables, which the cli will provide automatically:

- `${{PROJECT_NAME}}` = Name of the project, which is a mandatory question of the cli
- `${{PROJECT_NAME_CONTAINER}}` = Same as above, just in [kebab-case](https://medium.com/better-programming/string-case-styles-camel-pascal-snake-and-kebab-case-981407998841#a084).

*Note: This configuration will use an environment variable from the host system: `${VARIABLE_NAME}`. Don't confuse the notations*

### Use of conditional sections
*To be extended ...*

## Environment file ([example file](frontend/angular/environment.env))
This file consists of key-value pares, and is not mandatory and should only be used for secrets, usernames, configurable paths, urls, etc.
The `environment.env` file is the only one where the secret variables (the ones starting with an underscore) from the configuration file will be applied by the cli.<br>
The environment file can be attached to a container by including it into the compose file like this:
```
...
services:
  database:
	env_file:
	  - environment.env
...
```

## README file ([example file](frontend/angular/README.md))
This file contains instructions about using the predefined template.

## Input validators
You have the option to validate the user input for questions. Compose Generator is able to use all validators from the [go-playground/validator library](https://github.com/go-playground/validator#baked-in-validations). Furthermore you can use the following additional validators:

-	`port`: Requires an integer number between 0 and 65535